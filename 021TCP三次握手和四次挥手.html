<html>
<head>
  <title>021TCP三次握手和四次挥手</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601568 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4633"/>
<h1>021TCP三次握手和四次挥手</h1>

<div>
<span><div style="margin: 0px; padding: 0px; text-size-adjust: none; font-size: 17px; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248);"><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">引言</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">TCP三次握手和四次挥手不管是在开发还是面试中都是一个非常重要的知识点，它是我们优化web程序性能的基础。但是大部分教材都对这部分解释的比较抽象，本文我们就利用wireshark来抓包以真正体会整个流程的细节。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">三次握手（用于建立tcp链接）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">根据下面这幅图我们来看一下TCP三次握手。p.s: 每个箭头代表一次握手。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-size: 0.48rem; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 0.76rem;"><img src="021TCP三次握手和四次挥手_files/Image.jpg" type="image/jpeg" data-filename="Image.jpg" style="margin: 0px 0px 0.133333rem; padding: 0px; line-height: 1; text-size-adjust: none; display: block; width: 724.813px; height: auto; max-width: none !important;"/></span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">tcp三次握手</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">第一次握手（发送握手报文）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">client发送一个SYN(J)包给server，然后等待server的ACK回复，进入SYN-SENT状态。p.s: SYN为synchronize的缩写，ACK为acknowledgment的缩写。</span></div></div><div style="margin: 0px; padding: 0px; text-size-adjust: none; font-size: 17px; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248);"><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">第二次握手（服务端发送确认报文）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">server接收到SYN(seq=J)包后就返回一个ACK(J+1)包以及一个自己的SYN(K)包，然后等待client的ACK回复，server进入SYN-RECIVED状态。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">第三次握手（发送确认报文已经收到的消息 为了防止报文在中途丢失 网络中断等 服务端又一直开着消耗资源）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">client接收到server发回的ACK(J+1)包后，进入ESTABLISHED状态。然后根据server发来的SYN(K)包，返回给等待中的server一个ACK(K+1)包。等待中的server收到ACK回复，也把自己的状态设置为ESTABLISHED。到此TCP三次握手完成，client与server可以正常进行通信了。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">为什么要进行三次握手</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">我们来看一下为什么需要进行三次握手，两次握手难道不行么？这里我们用一个生活中的具体例子来解释就很好理解了。我们可以将三次握手中的客户端和服务器之间的握手过程比喻成A和B通信的过程：</span></div><ul style="margin: 0px 0px 0.666667rem 1em; padding: 0px; text-size-adjust: none; list-style: disc; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><li style="margin: 0px; padding: 0px; text-size-adjust: none; list-style-type: inherit; list-style-position: initial; list-style-image: initial; font-size: 0.48rem !important;"><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">在第一次通信过程中，A向B发送信息之后，B收到信息后可以确认自己的收信能力和A的发信能力没有问题。</span></div></li><li style="margin: 0px; padding: 0px; text-size-adjust: none; list-style-type: inherit; list-style-position: initial; list-style-image: initial; font-size: 0.48rem !important;"><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">在第二次通信中，B向A发送信息之后，A可以确认自己的发信能力和B的收信能力没有问题，</span><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">但是B不知道自己的发信能力到底如何</span><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">，所以就需要第三次通信。</span></div></li><li style="margin: 0px; padding: 0px; text-size-adjust: none; list-style-type: inherit; list-style-position: initial; list-style-image: initial; font-size: 0.48rem !important;"><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">在第三次通信中，A向B发送信息之后，B就可以确认自己的发信能力没有问题。</span></div></li></ul><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">在第一次通信过程中，A向B发送信息之后，B收到信息后可以确认自己的收信能力和A的发信能力没有问题。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">在第二次通信中，B向A发送信息之后，A可以确认自己的发信能力和B的收信能力没有问题，</span><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">但是B不知道自己的发信能力到底如何</span><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">，所以就需要第三次通信。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">在第三次通信中，A向B发送信息之后，B就可以确认自己的发信能力没有问题。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem !important;"><br/></span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem !important;"><br/></span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">----------------------------------四次挥手---------------------------------------</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; font-size: 0.48rem !important;"><br/></span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 0.76rem; font-weight: bold;">四次挥手（用于释放tcp链接）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">以下面这张图为例，我们来分析一下TCP四次挥手的过程。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-size: 0.48rem; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 0.76rem;"><img src="021TCP三次握手和四次挥手_files/Image.webp" type="image/webp" data-filename="Image.webp" style="margin: 0px 0px 0.133333rem; padding: 0px; line-height: 1; text-size-adjust: none; display: block; width: 724.813px; height: auto; max-width: none !important;"/></span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="font-size: 9pt; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;;"><img src="021TCP三次握手和四次挥手_files/Image.png" type="image/png" data-filename="Image.png"/></span><br/></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">tcp四次挥手</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">第一次挥手（提交关闭请求）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">client发送一个FIN(M)包，此时client进入FIN-WAIT-1状态，这表明client已经没有数据要发送了。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">第二次挥手（接受到关闭请求了）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">server收到了client发来的FIN(M)包后，向client发回一个ACK(M+1)包，此时server进入CLOSE-WAIT状态，client进入FIN-WAIT-2状态。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">第三次挥手（发送关闭的数据给服务端）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">server向client发送FIN(N)包，请求关闭连接，同时server进入LAST-ACK状态。</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem !important;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1; font-weight: bold;">第四次挥手（最后的确认已经收到关闭的报文没 如果不发送的话服务器一直会发三次挥手来确认）</span></div><div style="margin: 0px 0px 0.666667rem; padding: 0px; text-size-adjust: none; text-align: justify; word-break: break-word; font-size: 0.48rem !important;"><span style="background-color: rgb(248, 248, 248); font-size: 0.48rem;"><span style="text-size-adjust: none; word-break: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); font-size: 0.48rem; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, Arial, &quot;\\5FAE软雅黑&quot;, &quot;\\5B8B体&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1;">client收到server发送的FIN(N)包，进入TIME-WAIT状态。向server发送ACK(N+1)包，server收到client的ACK(N+1)包以后，进入CLOSE状态；client等待一段时间还没有得到回复后判断server已正式关闭，进入CLOSE状态。</span></span></div></div><div><br/></div></span>
</div></body></html> 